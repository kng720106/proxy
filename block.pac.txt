// simple-blacklist.pac
// 保存名: simple-blacklist.pac
// 使い方: ブラウザ/OSのプロキシ自動構成URLにこのファイルを指定

function FindProxyForURL(url, host) {
    // ブロック対象（シンプルに一覧を記載）
    // 先頭に "." を付けるとそのドメインとサブドメイン全部をブロック
    // ワイルドカードは shExpMatch で判定可能（例: "*.ads.example.com"）
    var blacklist = [
        ".example.com",
        "badsite.net",
        "ads.tracker.io",
        "192.0.2.1"
    ];

    // ホストが IP リテラルかどうかを簡易判定
    var isIP = /^\d+\.\d+\.\d+\.\d+$/.test(host);

    for (var i = 0; i < blacklist.length; i++) {
        var b = blacklist[i];

        // IP 直接比較（ブラックリストにIPがある場合）
        if (isIP && b === host) return "PROXY 127.0.0.1:9";

        // ドメイン末尾一致（".example.com" 形式）
        if (b.charAt(0) === ".") {
            if (dnsDomainIs(host, b) || host === b.substring(1)) return "PROXY 127.0.0.1:9";
            continue;
        }

        // ワイルドカード or シェル式マッチ
        if (b.indexOf("*") !== -1 || b.indexOf("?") !== -1) {
            if (shExpMatch(host, b)) return "PROXY 127.0.0.1:9";
            continue;
        }

        // 完全一致（ホスト名）
        if (host === b) return "PROXY 127.0.0.1:9";
    }

    // ローカル / プライベート系は直接接続
    if (isPlainHostName(host) || shExpMatch(host, "*.local") ||
        shExpMatch(host, "localhost") ) {
        return "DIRECT";
    }

    // デフォルトは直接接続
    return "DIRECT";
}
